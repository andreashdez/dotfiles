<?xml version="1.0"?>
<!-- Copyright (c) 2017 Haggai Nuchi
Available for use under the MIT License:
https://opensource.org/licenses/MIT
-->

<!-- Run userChrome.js/userChrome.xul and .uc.js/.uc.xul/.css files  -->
<bindings xmlns="http://www.mozilla.org/xbl">
	<binding id="js" extends="chrome://global/content/bindings/toolbarbutton.xml#menu">
		<implementation>
			<constructor>
				<![CDATA[

				function makeRelativePathURI(name) {
					let absolutePath = Components.stack.filename;
					return absolutePath.substring(0, absolutePath.lastIndexOf("/") + 1) + name;
				}
				// The following code executes in the browser context,
				// i.e. chrome://browser/content/browser.xul
				Services.scriptloader.loadSubScriptWithOptions(makeRelativePathURI("userChrome.js"), {target: window, ignoreCache: true});

				]]>
			</constructor>
		</implementation>
	</binding>
</bindings>

